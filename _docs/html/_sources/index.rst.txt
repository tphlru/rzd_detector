.. LaboRad HSD documentation master file, created by
   sphinx-quickstart on Thu Jan 23 19:01:15 2025.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Документация LaboRad HSD
========================

Добро пожаловать в документацию LaboRad HSD! Надеемся, что тут вы найдете ответ на любой интересующий вас вопрос.

.. contents:: Содержание
   :depth: 3
   :local:

Доступ
~~~~~~

Основной код доступен на нашем GitHub_.
Нашей командой написан специальный веб-интерфейс, позволяющий получить доступ к приложению практически из любого места. Публичный сервер доступен на http://tphl.duckdns.org.

.. _GitHub: https://github.com/tphlru/rzd_detector

Начало работы 
~~~~~~~~~~~~~

В данной главе будет разобрана первая проверка.

#. **Переход к следующей проверке**. Для этого нажимаем кнопку **Следующий** в *панели управления*.
#. **Выбор устройства**. Для выбора устройства HSD Camera нажимаем в *панели управления* на список **Устройства**.
#. **Ввод данных**. Пользуясь разделом **Данные**, введите данные о проверяемом. Свою оценку внешности и впечатления введите в подраздел **Субъективная оценка**.
#. **Проверка**. Проверяя разделы **Критерии** и **Графики** проверьте результаты первично самостоятельно.
#. **Вывод результатов**. В *панели управления* выберите критерии, которые будут учитываться. Нажмите на кнопку **Показать отчет** для подведения итогов.

Интерфейс 
~~~~~~~~~

Реализован на HTML с использованием CSS и JS. Ниже представлен скриншот версии 2024.12.13a

.. image:: _static/images/screenshot_full.png
   :width: 100 %
   :alt: alternate text
   :align: center

В следующих разделах разберем каждый рабочий блок в приложении.

Видео
"""""

.. image:: _static/images/video.png
   :width: 100 %
   :alt: alternate text
   :align: center

В данный блок выводится видео с вашей камеры. Можно настроить громкость, включить полноэкранный режим.

Панель управления
"""""""""""""""""

.. image:: _static/images/mainpanel.png
   :width: 100 %
   :alt: alternate text
   :align: center

В этом блоке можно управлять проверкой, вывести отчет и другое.

**Следующий** - кнопка для завершения проверки этого человека и перехода к следующему.

**Остановить** - кнопка для остановки проверки.

**Показать подробную информацию** - кнопка для вывода на экран более подробной информации о проверке.

**Показать запись** - кнопка для вывода на экран записей с камер с прошлых проверок.

**Устройство** - выбор устройства HSD Camera с которого будет происходить съемка.

**Настройки подсчета** - включение/выключение некоторых факторов, которые влияют на итоговую оценку.

**Показать отчет** - используя данные из **Настроек подсчета** вывести на экран итоговую оценку проверки.

Данные
""""""

.. image:: _static/images/data.png
   :width: 100 %
   :alt: alternate text
   :align: center

В этом блоке можно ввести информацию о пассажире, такие как пункт отправления, пункт прибытия, пол, возраст и др. данные которые повлияют на итоговую оценку.

**Пол** - пол проверяемого.

**Возраст** - возраст проверяемого.

**Место посадки/высадки** - город отправления и прибытия проверяемого.

**Субъективная оценка** - личное отношение к внешности и манерам, возникающее у проверяющего.

**Первый вопрос** и **Второй вопрос** - вопросы, выбранные при настройке программы, которые должны быть заданы проверяемому.

.. _`Критерии`:

Критерии
""""""""

В данный блок выводятся данные все данные о проверяемом в виде таблицы.

**Критерии** - группы для подуровней 

**Подуровни** - критерии, по которым происходит оценка

**Баллы** - оценка проверяемого по этому критерию

**Общий балл** - средний балл по этим критериям

Графики
"""""""

Это раздел для вывода информации проверяемом - его пульсе, частоте дыхания и моргания, сезонность одежды и другие показатели в данный момент, предоставленные для удобства в виде графиков.

HSD Camera 
~~~~~~~~~~

HSD Camera - это камера, которая может крепиться на стену, висеть на проверяющем или стоять на подставке, позволяющая вести запись проверяемого. Состоит из платы Raspberry Pi, камеры к ней и аккамулятора.

Замена аккамулятора
"""""""""""""""""""

oioioio

Развертывание на собственном сервере
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для начала нам потребуется Python с версией ">=3.9.0,<3.11"

Установка библиотек
"""""""""""""""""""

.. code-block:: shell

   pip install poetry cython
   poetry lock
   poetry install

.. code-block:: shell

   pip install -r ../requirements.txt
   conda install compilers libstdcxx-ng=12
   conda install webrtcvad

Настройка значений интерфейса по умолчанию
""""""""""""""""""""""""""""""""""""""""""

Для того, чтобы настроить значения по умолчанию в интерфейсе под себя, нам необходим файл `server.py`_. Открываем любым текстовым редактором, находим в начале список "data". Его мы корректируем под собственные нужды. Все значения переменных в этом списке перечислены ниже.

**gender** - пол

**age** - возраст

**departure** - пункт отправления

**arrival** - пункт прибытия

**subjective_rating** - субъективная оценка

**question1** - вопрос 1

**question2** - вопрос 2

**criteria** - управление разделом `Критерии`_

**pulse_status** - статус пульса (нормально/участившийся/замедлившийся)

**breathing_status** - статус частоты дыхания

**blinking_value** - частота моргания в минуту

**emotions** - эмоции 

**physical** - физическое состояние

**seasonal** - сезонность одежды (где True - в норме, False - не по сезону)

**subjective** - субъективная оценка

**statistical** - статистическая оценка

.. _`server.py`: https://github.com/tphlru/rzd_detector/gui/revised_2025/server.py

Запуск
""""""

Основной интерфейс находится в `этой папке`_, связанный интерфейс находится тут_.

.. _`этой папке`: https://github.com/tphlru/rzd_detector/tree/main/gui/laborad_detector
.. _тут: https://github.com/tphlru/rzd_detector/tree/main/gui/laborad_detector

Публикация
""""""""""

.. code-block:: shell

   poetry lock
   poetry install
   poetry publish --build
